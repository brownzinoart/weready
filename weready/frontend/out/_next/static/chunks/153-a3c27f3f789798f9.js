"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[153],{3153:function(e,t,s){s.d(t,{Z:function(){return f}});var a=s(7437),r=s(2265),l=s(4697),o=s(2940),n=s(6780),i=s(7055),c=s(2022),d=s(4086),u=s(4453),h=s(7019),m=s(5733),x=s(7397);function f(e){let{isOpen:t,onClose:s,defaultTab:f="login",analysisId:p}=e,[g,b]=(0,r.useState)(f),[v,w]=(0,r.useState)(!1),[j,y]=(0,r.useState)(!1),[N,k]=(0,r.useState)(""),[S,_]=(0,r.useState)(""),[C,I]=(0,r.useState)(""),[P,T]=(0,r.useState)(""),[E,Z]=(0,r.useState)(""),[A,F]=(0,r.useState)(""),[O,z]=(0,r.useState)(null),{login:W}=(0,x.a)();(0,r.useEffect)(()=>{t?(k(""),_(""),z(null)):(I(""),T(""),Z(""),F(""),w(!1))},[t,g]),(0,r.useEffect)(()=>{"signup"===g&&P.length>0?q(P):z(null)},[P,g]);let q=async e=>{try{let t=await fetch("http://localhost:8000/api/auth/password-strength",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})});if(t.ok){let e=await t.json();z(e)}}catch(s){let t=B(e);z({score:t,strength:t<=3?"weak":t<=6?"medium":"strong",feedback:[]})}},B=e=>{let t=0;return e.length>=8&&(t+=1),e.length>=12&&(t+=1),/[a-z]/.test(e)&&(t+=1),/[A-Z]/.test(e)&&(t+=1),/\d/.test(e)&&(t+=1),/[!@#$%^&*(),.?":{}|<>]/.test(e)&&(t+=1),t},J=async e=>{e.preventDefault(),k(""),_(""),y(!0);try{if("signup"===g){if(!E.trim())throw Error("Full name is required");if(P!==A)throw Error("Passwords do not match");if(O&&"weak"===O.strength)throw Error("Please choose a stronger password");let e=await fetch("http://localhost:8000/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:C,password:P,full_name:E})}),t=await e.json();if(!e.ok)throw Error(t.detail||"Signup failed");localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token),_("Welcome to WeReady! You have ".concat(t.trial_days_remaining," days of free trial.")),setTimeout(()=>{s(),window.location.href=t.is_new_user?"/onboarding":"/dashboard"},1500)}else{let e=await fetch("http://localhost:8000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:C,password:P})}),t=await e.json();if(!e.ok)throw Error(t.detail||"Login failed");localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token),_("Welcome back to WeReady!"),setTimeout(()=>{s(),window.location.href="/dashboard"},1e3)}}catch(e){k(e.message)}finally{y(!1)}},D=e=>{let t=p?"http://localhost:8000/api/auth/".concat(e,"?analysis_id=").concat(p):"http://localhost:8000/api/auth/".concat(e);window.location.href=t};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"login"===g?"Welcome Back":"Join WeReady"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"login"===g?"Sign in to your account":"Start your free 7-day trial"})]}),(0,a.jsx)("button",{onClick:s,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:(0,a.jsx)(l.Z,{className:"w-5 h-5 text-slate-500"})})]}),(0,a.jsxs)("div",{className:"flex border-b border-slate-200",children:[(0,a.jsx)("button",{onClick:()=>b("login"),className:"flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-colors ".concat("login"===g?"border-violet-600 text-violet-600":"border-transparent text-slate-500 hover:text-slate-700"),children:"Sign In"}),(0,a.jsx)("button",{onClick:()=>b("signup"),className:"flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-colors ".concat("signup"===g?"border-violet-600 text-violet-600":"border-transparent text-slate-500 hover:text-slate-700"),children:"Sign Up"})]}),(0,a.jsxs)("div",{className:"p-6",children:[S&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-green-50 border border-green-200 rounded-lg mb-4",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm text-green-800",children:S})]}),N&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg mb-4",children:[(0,a.jsx)(n.Z,{className:"w-5 h-5 text-red-600"}),(0,a.jsx)("span",{className:"text-sm text-red-800",children:N})]}),(0,a.jsx)("div",{className:"space-y-3 mb-6",children:(0,a.jsxs)("button",{onClick:()=>D("github"),className:"w-full flex items-center justify-center space-x-3 py-3 px-4 border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Continue with GitHub"})]})}),(0,a.jsxs)("div",{className:"relative mb-6",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,a.jsx)("div",{className:"w-full border-t border-slate-200"})}),(0,a.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,a.jsx)("span",{className:"px-2 bg-white text-slate-500",children:"Continue with email"})})]}),(0,a.jsxs)("form",{onSubmit:J,className:"space-y-4",children:["signup"===g&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:"text",id:"fullName",value:E,onChange:e=>Z(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"Enter your full name",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:"email",id:"email",value:C,onChange:e=>I(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"Enter your email",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:v?"text":"password",id:"password",value:P,onChange:e=>T(e.target.value),className:"w-full pl-10 pr-12 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"signup"===g?"Create a strong password":"Enter your password",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>w(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600",children:v?(0,a.jsx)(h.Z,{className:"w-5 h-5"}):(0,a.jsx)(m.Z,{className:"w-5 h-5"})})]}),"signup"===g&&O&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"flex-1 bg-slate-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all ".concat("weak"===O.strength?"bg-red-500 w-1/3":"medium"===O.strength?"bg-yellow-500 w-2/3":"bg-green-500 w-full")})}),(0,a.jsx)("span",{className:"text-xs font-medium capitalize ".concat("weak"===O.strength?"text-red-600":"medium"===O.strength?"text-yellow-600":"text-green-600"),children:O.strength})]})})]}),"signup"===g&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,a.jsx)("input",{type:v?"text":"password",id:"confirmPassword",value:A,onChange:e=>F(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"Confirm your password",required:!0})]}),A&&P!==A&&(0,a.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Passwords do not match"})]}),(0,a.jsx)("button",{type:"submit",disabled:j,className:"w-full bg-gradient-to-r from-violet-600 to-purple-600 text-white font-medium py-3 px-4 rounded-lg hover:from-violet-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:j?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"signup"===g?"Creating Account...":"Signing In..."})]}):"signup"===g?"Start Free Trial":"Sign In"})]}),(0,a.jsx)("div",{className:"mt-6 text-center",children:"login"===g?(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Don't have an account?"," ",(0,a.jsx)("button",{onClick:()=>b("signup"),className:"text-violet-600 hover:text-violet-700 font-medium",children:"Sign up for free"})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"By signing up, you agree to our Terms of Service and Privacy Policy"}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Already have an account?"," ",(0,a.jsx)("button",{onClick:()=>b("login"),className:"text-violet-600 hover:text-violet-700 font-medium",children:"Sign in"})]})]})})]})]})}):null}},7397:function(e,t,s){s.d(t,{AuthProvider:function(){return n},a:function(){return o}});var a=s(7437),r=s(2265);let l=(0,r.createContext)(void 0);function o(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function n(e){let{children:t}=e,[s,o]=(0,r.useState)(null),[n,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0),u=!!s;(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("access_token");if(e)try{let t=await fetch("http://localhost:8000/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();o(e)}else await h()||(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"))}catch(e){console.error("Failed to load user:",e),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}d(!1)})()},[]);let h=async()=>{let e=localStorage.getItem("refresh_token");if(!e)return!1;try{let t=await fetch("http://localhost:8000/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(t.ok){let e=await t.json();localStorage.setItem("access_token",e.access_token);let s=await fetch("http://localhost:8000/api/auth/me",{headers:{Authorization:"Bearer ".concat(e.access_token)}});if(s.ok){let e=await s.json();return o(e),!0}}return!1}catch(e){return console.error("Token refresh failed:",e),!1}},m=async e=>{try{let t;let s=localStorage.getItem("access_token"),a=await fetch("http://localhost:8000/api/user/analyses/summary",{headers:{Authorization:"Bearer ".concat(s)}}),r=0,l=!1;if(a.ok){let e=await a.json();r=e.total_analyses||0,t=e.last_analysis_date,l=r>0}let o=new Date().getTime()-new Date(e.created_at).getTime()<6048e5||0===r?"new":"returning",n="auto";"developer"===e.role&&(n="technical"),"investor"===e.role&&(n="business");let i="true"===localStorage.getItem("onboarding_completed_".concat(e.id));return{userType:o,hasAnalyses:l,analysisCount:r,onboardingCompleted:i,lastAnalysisDate:t,preferredView:n}}catch(e){return console.error("Failed to classify user:",e),{userType:"new",hasAnalyses:!1,analysisCount:0,onboardingCompleted:!1,preferredView:"auto"}}};return(0,r.useEffect)(()=>{s&&!n&&m(s).then(i)},[s,n]),(0,a.jsx)(l.Provider,{value:{user:s,userProfile:n,isAuthenticated:u,isLoading:c,login:(e,t)=>{let s="http://localhost:8000/api/auth/".concat(e),a=t?"".concat(s,"?analysis_id=").concat(t):s;window.location.href=a},logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),o(null),fetch("http://localhost:8000/api/auth/logout",{method:"POST"}).catch(console.error)},refreshToken:h,updateUserProfile:e=>{n&&(i({...n,...e}),e.onboardingCompleted&&s&&localStorage.setItem("onboarding_completed_".concat(s.id),"true"))},getViewMode:()=>n&&"auto"!==n.preferredView?"business"===n.preferredView?"business":"technical":(null==s?void 0:s.role)==="investor"?"business":(null==s?void 0:s.role)==="developer"?"technical":"business"},children:t})}}}]);